(()=>{"use strict";const t=function(){let t=function(t){let e=[];for(let t=0;t<7;t++){e[t]=[];for(let r=0;r<7;r++)e[t][r]={ship:null,triedHit:!1}}return e}(),e=[];return{board:t,placeShip:function(r,n,a,i=!1){let o=[r,n];if(!1===i){r+a.length-1>=7&&(o=[7-a.length,n]);let i=o[0],s=o[1];for(let e=0;e<a.length;e++)if(t[i+e][s].ship)return!1;e.push(a);for(let e=0;e<a.length;e++)t[i+e][s].ship=a}else{n+a.length-1>=7&&(o=[r,7-a.length]);let i=o[0],s=o[1];for(let e=0;e<a.length;e++)if(t[s+e][i].ship)return!1;e.push(a);for(let e=0;e<a.length;e++)t[s+e][i].ship=a}return!0},shipsOnBoard:e,receiveAttack:function(t,e){let r=this.board[t][e];return!(!r||r.triedHit||(r.triedHit=!0,null!==r.ship&&r.ship.hit(),0))},allSunk:function(){return e.every((t=>t.isSunk()))}}},e=function(){const e=new t,r=function(t,e){return this.opp.gameboard.receiveAttack(t,e)},n=function(t){return Math.floor(Math.random()*t)},a=new Set,i=function(t=n){let e=t(7),o=t(7);if(!a.has(this.opp.gameboard.board[e][o]))return r.call(this,e,o),a.add(this.opp.gameboard.board[e][o]),[e,o];i.call(this,t)};return{gameboard:e,opp:null,attack:r,aiAttack:i}},r=function(t){return{length:t,hit:function(){0==this.isSunk()&&this.hits++},hits:0,isSunk:function(){return this.hits>=this.length}}},n=(document.querySelector(".rotate"),document.querySelector(".new-game"),document.querySelector(".user-board")),a=document.querySelector(".ai-board");document.querySelector(".status"),function(){const t=new e,i=new e;t.opp=i,i.opp=t,r(5),r(4),r(3);const o=function(){for(let e=0;e<t.gameboard.board.length;e++)for(let r=0;r<t.gameboard.board[e].length;r++){const t=document.createElement("div");t.classList.add("grid-square"),t.dataset.x=r,t.dataset.y=e,t.textContent=`${r}, ${e}`,n.appendChild(t)}},s=function(){for(let t=0;t<i.gameboard.board.length;t++)for(let e=0;e<i.gameboard.board[t].length;e++){const r=document.createElement("div");r.classList.add("ai-grid-square"),r.dataset.x=e,r.dataset.y=t,r.textContent=`${e}, ${t}`,a.appendChild(r)}},l=function(e){let r;r=e==t?document.querySelectorAll(".grid-square"):document.querySelectorAll(".ai-grid-square"),r.forEach((t=>{let r=e.gameboard.board[parseInt(t.dataset.x)][parseInt(t.dataset.y)];null!=r.ship?(t.classList.add("ship"),r.triedHit&&(t.classList.remove("ship"),t.classList.add("damaged"))):r.triedHit&&t.classList.add("miss")}))};return{createUserBoard:o,createAiBoard:s,renderShips:l,placeAiShips:function(){const t=new r(3),e=new r(4),n=new r(5);i.gameboard.placeShip(0,0,t),i.gameboard.placeShip(2,4,e),i.gameboard.placeShip(5,0,n,!0),l(i)},startGame:function(){o(),s()}}}().startGame()})();